# Personalized News Dispatcher

これは、ユーザーがパーソナライズしたキーワードセットに基づき、News サイトから関連ニュースを自動収集し、ユーザーに HTML メールでダイジェストを配信するシステムです。

## プロジェクト構成

本プロジェクトは Django を用いて構築されており、主要なアプリケーションは以下の通りです。

*   `core`: プロジェクトの基本的な設定や、全アプリケーションで共通して利用されるテンプレート (`base.html`) を提供します。
*   `users`: ユーザー管理を担います。メールアドレスを用いたパスワードレス認証機能を有します。
*   `subscriptions`: ユーザーが購読するニュースのキーワードセット (QuerySet) の管理を行います。
*   `news`: 収集したニュース記事、配信ログ、クリックログの管理を行います。

### ディレクトリ構成

```
.
├── config/          # Django プロジェクト設定
├── core/            # 基本的なテンプレート等
├── data/            # 初期データ (カテゴリ情報)
├── log/             # ログファイル
├── news/            # ニュース記事関連
├── subscriptions/   # 購読設定関連
├── users/           # ユーザー認証関連
├── manage.py        # Django 管理コマンド
├── requirements.txt # Python 依存パッケージ
├── Makefile         # 各種コマンドのエイリアス
└── uwsgi.ini        # uWSGI 設定ファイル
```

## 主要機能

*   **ユーザー認証**: メールアドレスとワンタイムトークンを用いたパスワードレス認証を提供します。
*   **QuerySet**: ユーザーはニュース収集の条件を「QuerySet」として複数登録できます。QuerySet は以下の要素から構成されます。
    *   大分類 (例: 経済, IT)
    *   中分類 (例: 金融政策, ソフトウェア)
    *   関連キーワード
    *   任意キーワード
*   **ニュース収集**: `send_daily_news.py` 管理コマンドが、各ユーザーの QuerySet に基づき Google News の RSS からニュースを収集します。
*   **メール配信**: 収集したニュースをまとめ、HTML 形式のダイジェストメールをユーザーに配信します。
*   **クリック追跡**: メール内のニュースリンクには追跡用の URL が付与され、ユーザーのクリックを記録します。

## データベースモデル

*   `users.User`: ユーザー情報を格納します。
*   `users.LoginToken`: パスワードレス認証用のワンタイムトークンを格納します。
*   `subscriptions.LargeCategory`, `MediumCategory`, `RelatedKeywords`: ニュースの分類カテゴリを定義します。
*   `subscriptions.CustomKeywords`: ユーザーが任意に設定するキーワードを格納します。
*   `subscriptions.QuerySet`: ユーザーが作成したニュース収集条件のセットです。
*   `news.Article`: 収集したニュース記事の情報を格納します。
*   `news.SentArticleLog`: どの記事をどのユーザーに配信したかを記録します。
*   `news.ClickLog`: ユーザーの記事クリックを記録します。
